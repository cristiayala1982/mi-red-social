<!doctype html>
<html lang="es">
  <head>
    <!-- Metas requeridos para Bootstrap -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS de Bootstrap (aseg칰rate de que la ruta a tu archivo sea correcta o usa el CDN) -->
    <!-- Si usas un CDN, aseg칰rate de que sea la versi칩n 5.x -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Si tienes un archivo CSS propio, aseg칰rate de incluirlo aqu칤 -->
    <!-- <link rel="stylesheet" href="css/styles.css"> -->

    <title>Iniciar sesi칩n</title>
  </head>
  <body>

    <div class="container mt-5">
        <div class="row justify-content-center">
            <!-- Usamos col-md-4 para que coincida con tu registro -->
            <div class="col-md-4">
                <div class="card shadow p-3 mb-5 bg-white rounded">
                    <h1 class="text-center mb-4">Iniciar sesi칩n</h1>
                    <form id="form-login">
                        <div class="mb-3">
                          <label for="usuario-login" class="form-label">Usuario</label>
                          <input type="text" class="form-control" id="usuario-login"
                          placeholder="name1982" autocomplete="username" required>
                        </div>
                        <div class="mb-3">
                          <label for="password-login" class="form-label">Contrase침a</label>
                          <input type="password" class="form-control" id="password-login"
                          placeholder="1234" autocomplete="current-password" required>
                        </div>
                          <button type="submit" class="btn btn-primary w-100">Iniciar sesi칩n</button>
                          <p class="text-center mt-3">
                            쯅o tienes cuenta? <a href="register.html" class="text-primary">Reg칤strate</a>
                          </p>
                          <p id="mensaje-login" class="text-center mt-3"></p>
                    </form>
                </div>
            </div>
        </div>
    </div>


<script>  
        const API_URL = "https://phonic-odyssey-480319-a4.rj.r.appspot.com";
        const formLogin = document.getElementById('form-login');
        formLogin.addEventListener('submit', (e) => {
            e.preventDefault();
            const usuario = document.getElementById('usuario-login').value;
            const password = document.getElementById('password-login').value;
            const mensajeLogin = document.getElementById('mensaje-login')

            fetch(`${API_URL}/api/usuario/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include', // 游녣 esto permite que se guarde la cookie
                body: JSON.stringify({usuario, password }),
            })
                //console.log(nombre,password)
                .then((response) => response.json())
                .then((data) => {
                if (data.success) {
                    window.location.href = 'home.html';
                    } else {
                        mensajeLogin.textContent = 'Usuario o contrase침a incorrectos';
                        mensajeLogin.style.color = 'red';
                    }
                    console.log(data)
                })
                .catch((error) => console.error(error));
        })

    </script>
  </body>
</html>
