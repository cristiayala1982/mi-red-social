<!DOCTYPE html>
<html>
  <head>
    <title>Mi red social</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta charset="UTF-8" />
  </head>
  <body>
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    background: #f0f0f0;
  }

  .login-fullscreen {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
  }

  .login-card {
    width: 100%;
    max-width: 500px;
    background: white;
    border-radius: 16px;
    padding: 32px 24px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
  }

  h1 {
    font-size: 28px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 24px;
    color: green;
  }

  h2 {
    font-size: 24px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 24px;
  }

  .form-label {
    font-size: 18px;
    margin-bottom: 8px;
  }

  .form-control-lg {
    font-size: 18px;
    padding: 14px 18px;
    height: auto;
  }

  .btn-lg {
    font-size: 20px;
    padding: 14px 18px;
    border-radius: 12px;
  }

  .text-small {
    font-size: 16px;
    text-align: center;
  }
</style>

<div class="login-fullscreen">
  <div class="login-card">
    <h1>칔ltima correcci칩n</h1>
    <h2>Iniciar sesi칩n</h2>

    <form id="form-login">
      <div class="mb-4">
        <label for="usuario-login" class="form-label">Usuario</label>
        <input type="text" class="form-control form-control-lg" id="usuario-login"
               placeholder="name1982" autocomplete="username" required>
      </div>

      <div class="mb-4">
        <label for="password-login" class="form-label">Contrase침a</label>
        <input type="password" class="form-control form-control-lg" id="password-login"
               placeholder="1234" autocomplete="current-password" required>
      </div>

      <button type="submit" class="btn btn-primary btn-lg w-100">Iniciar sesi칩n</button>

      <p class="mt-4 text-small">
        쯅o tienes cuenta? <a href="register.html" class="text-primary">Reg칤strate</a>
      </p>
      <p id="mensaje-login" class="mt-3 text-small"></p>
    </form>
  </div>
</div>

<script>  
        const API_URL = "https://phonic-odyssey-480319-a4.rj.r.appspot.com";
        const formLogin = document.getElementById('form-login');
        formLogin.addEventListener('submit', (e) => {
            e.preventDefault();
            const usuario = document.getElementById('usuario-login').value;
            const password = document.getElementById('password-login').value;
            const mensajeLogin = document.getElementById('mensaje-login')

            fetch(`${API_URL}/api/usuario/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include', // 游녣 esto permite que se guarde la cookie
                body: JSON.stringify({usuario, password }),
            })
                //console.log(nombre,password)
                .then((response) => response.json())
                .then((data) => {
                if (data.success) {
                    window.location.href = 'home.html';
                    } else {
                        mensajeLogin.textContent = 'Usuario o contrase침a incorrectos';
                        mensajeLogin.style.color = 'red';
                    }
                    console.log(data)
                })
                .catch((error) => console.error(error));
        })

    </script>
  </body>
</html>
